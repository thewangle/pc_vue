(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-76c9"],{"+UXW":function(t,e,a){"use strict";a.r(e);var i=a("P2sY"),n=a.n(i),s=a("FyfS"),o=a.n(s),l=a("gDS+"),r=a.n(l),c=a("EJiy"),u=a.n(c),d=a("14Xm"),p=a.n(d),f=a("D3Ub"),m=a.n(f),h=a("GQeE"),v=a.n(h),y=a("zK94"),g=a("dYX8"),_=a("+vOl"),b=a("X4fA"),k=a("8SHQ"),w=a("vDqi"),I=a.n(w),x=a("ZySA"),T=(a("XJYT"),{name:"ActivityManage",directives:{waves:x.a},filters:{statusFilter:function(t){return{"-1":"已撤销",1:"待审核",2:"准备中审核通过",3:"已开始进行中",4:"暂停",5:"结束已完成 ",6:"审核未通过"}[t]},activityFilter:function(t){return{1:"团队-基础版",2:"个人-基础版"}[t]},typeFilter:function(t){return{1:"选择题",2:"文字题",3:"图片题",4:"视频题",5:"语音题",6:"拍照题"}[t]},answerTypeFilter:function(t){return{1:"普通题",2:"关卡题",3:"限时题",4:"抢答题"}[t]},timeFilter:function(t){var e=new Date(1e3*t);return e.getFullYear()+"-"+((+e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-")+((+e.getDate()<10?"0"+e.getDate():e.getDate())+" ")+((+e.getHours()<10?"0"+e.getHours():e.getHours())+":")+((+e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())+":")+(+e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds())}},data:function(){return{jindu:0,is_progress:!1,needCoach:"1",longTime:"2",needTpl:"2",taskCheckedList:[],taskTotal:0,taskListQuery:{page_no:1,page_size:10},tasklistData:[],dialogTaskList:!1,dialogActivityTitle:"",dialogActivitytype:"",iconFilelist:[],bgFileList:[],taskQFileList:[],taskAFileList:[],list:null,listLoading:!1,total:0,listQuery:{page_no:1,page_size:10,type:null,agent_name:null,name:null,status:null,person_coach:null},activities:[{label:"团队-基础版",key:1},{label:"个人-基础版",key:2}],status:[{label:"已撤销",key:"-1"},{label:"待审批",key:"1"},{label:"准备中",key:"2"},{label:"进行中",key:"3"},{label:"暂停中",key:"4"},{label:"已完成",key:"5"},{label:"未通过",key:"6"}],dialogFormVisible:!1,dialogFormDisable:!1,dialogAddTaskVisible:!1,taskList:[],dialogTaskVisible:!1,dialogTaskTitle:"",dialogTaskType:"",dialogTaskImgVisible:!1,dialogTaskImageUrl:"",dialogCheckVisible:!1,dialogTitle:"",dialogType:"",dialogReasonVisible:!1,reason:"",payMoney:Object(b.f)(),dialogPayVisible:!1,activityInfo:{agentName:Object(b.b)(),type:"",coachId:"",name:"",keepTime:"",score:"",scoreType:"",scoreShowType:"",time:"",actDesc:"",bgImgUrl:"",iconUrl:"",gif_url:"",price:"",tplId:"",check:""},activityId:null,dialogMap:!1,chooseLocation:[],locationName1:"",taskInfo:{name:null,type:"1",desc:null,answer_type:"1",seq:null,question_img:null,options:{A:null,B:null,C:null,D:null},answer:[],answer2:"",answer_url:"",score:null,answer_limit:1,limit_time:"",classification:"0",location_point:""},dialogImageUrl:"",dialogVisible:!1,dialogAnswerImageUrl:"",dialogAnswerImgVisible:!1,nineImageUrl:"",dialogNineVisible:!1,coachList:[],tplList:[],domain:"http://upload.qiniup.com/",qiniuAddress:k.a,checkInfo:{name:null,type:null,set_start_time:null,set_stop_time:null,money:null},pay_er_img:null,set_start_time:"",set_stop_time:"",payType:"1",gifFileList:[],activity:{},level:Object(b.e)(),taskClassfiyList:[],searchLocation:"",searchService:null}},computed:{showable:function(){return+Object(b.e)()>4},checkdisabled:function(){return"1"===this.longTime},locationName:function(){var t=new qq.maps.Geocoder,e=this.taskInfo.location_point?this.taskInfo.location_point.split(","):"";if(!e||!e.length)return"暂无定位";var a=e[0],i=e[1],n=new qq.maps.LatLng(a,i);t.getAddress(n);var s=this;return t.setComplete(function(t){var e="";v()(t.detail.addressComponents).forEach(function(a){e+=t.detail.addressComponents[a]}),s.locationName1=e}),s.locationName1},optionsLength:function(){return v()(this.taskInfo.options).length},lastKey:function(){return v()(this.taskInfo.options)[this.optionsLength-1]}},created:function(){this.init()},methods:{handleDeleteLocation:function(){this.taskInfo.location_point="",this.chooseLocation=[],this.locationName1=""},handleChangeTaskSort:function(t,e){var a=this;return m()(p.a.mark(function i(){return p.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return console.log(t,e),1,"up"===e&&(e=1),"down"===e&&(e=2),i.prev=4,i.next=7,Object(y.F)(t.id,e);case 7:i.next=11;break;case 9:i.prev=9,i.t0=i.catch(4);case 11:a._fetchTaskList(a.activityId);case 12:case"end":return i.stop()}},i,a,[[4,9]])}))()},handleConsole:function(t){return console.log(this.taskInfo.answer),-1!==this.taskInfo.answer.indexOf(t)},handleAddNewLine:function(){if("Z"!==this.lastKey){console.log(u()(this.lastKey));var t=this.lastKey.charCodeAt();++t,console.log(t);var e=String.fromCharCode(t);console.log(e),this.$set(this.taskInfo.options,e,null),console.log(this.taskInfo.options)}else this.$message({message:"不能再增加选项啦~",type:"error"})},handleClickOption:function(t){1!==this.optionsLength?(this.$delete(this.taskInfo.options,t),console.log(this.taskInfo.options)):this.$message({message:"不能再删啦~"})},handleCheckBoxChange:function(t,e){if(!t||this.taskInfo.answer.indexOf(e)>=0||this.taskInfo.answer.push(e),!t&&this.taskInfo.answer.indexOf(e)>=0){var a=[];this.taskInfo.answer.forEach(function(t){t!==e&&a.push(t)}),this.taskInfo.answer=a}},handleSearchLocation:function(){this.searchLocation.trim()||(this.searchLocation="",this.$message({message:"地址不能为空",type:"error"})),this.searchService.search(this.searchLocation)},handleSaveLocation:function(){this.$set(this.taskInfo,"location_point",this.chooseLocation.join()),this.dialogMap=!1},handleOpenTenceMap:function(){var t=this;return m()(p.a.mark(function e(){var a,i;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.chooseLocation=[],t.searchLocation="",t.dialogMap=!0,Object(b.d)(),a=Object(b.c)(),t,i=!0,t.$nextTick(function(){var e=new qq.maps.Map(document.getElementById("map-container")),n=new qq.maps.SearchService({complete:function(t){if("CITY_LIST"===t.type&&t.detail.cities.length>0)s.$message({message:"请输入详细地址",type:"error"});else{for(var a=t.detail.pois,i=new qq.maps.LatLngBounds,n=0,o=a.length;n<o;n++){var l=a[n];i.extend(l.latLng)}e.fitBounds(i),e.setZoom(16)}},error:function(){s.$message({message:"没有搜索到该位置",type:"error"}),s.searchLocation=""}}),s=t,o=new qq.maps.CityService({map:e,complete:function(t){var a=t.detail.latLng,i=a.lat,n=a.lng;s.chooseLocation.push(i),s.chooseLocation.push(n),e.setZoom(18),e.setCenter(t.detail.latLng),d.setPosition(t.detail.latLng)}});t.searchService=n;var l=new qq.maps.Geocoder;if(a&&!t.taskInfo.location_point)o.searchCityByIP(a),console.log(a);else{if(!t.taskInfo.location_point)return i=!1,void t.$message({message:"该运营商没有设置城市",type:"error"});i=!1;var r=t.taskInfo.location_point.split(",")[0],c=t.taskInfo.location_point.split(",")[1];t.chooseLocation.push(r),t.chooseLocation.push(c);var u=new qq.maps.LatLng(r,c);l.getAddress(u)}var d=new qq.maps.Marker({map:e,content:"定位地点"});d.setVisible(!0),d.setAnimation(qq.maps.MarkerAnimation.DOWN),l.setComplete(function(t){e.setCenter(t.detail.location),e.setZoom(16);var a="";v()(t.detail.addressComponents).forEach(function(e){a+=t.detail.addressComponents[e]}),i||(d.setTitle(a||t.detail.address),d.setPosition(t.detail.location))}),qq.maps.event.addListener(e,"click",function(t){var e=t.latLng.getLng(),a=t.latLng.getLat(),n=new qq.maps.LatLng(a,e);console.log(a,e),s.chooseLocation=[],s.chooseLocation.push(a),s.chooseLocation.push(e),i=!1,l.getAddress(n)}),qq.maps.event.addListener(d,"click",function(t){s.$alert(""+t.target.title,"定位地点")})});case 8:case"end":return e.stop()}},e,t)}))()},handleSubmitLibTask:function(){var t=this;return m()(p.a.mark(function e(){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.taskCheckedList.length){e.next=3;break}return t.$message({message:"请选择要导入的题目",type:"error"}),e.abrupt("return");case 3:return e.prev=3,e.next=6,Object(y.i)({activity_id:t.activityId,task_lib_ids:r()(t.taskCheckedList)});case 6:e.sent,t.$message({message:"导入成功",type:"success"}),t._fetchTaskList(t.activityId),t.handleCloseTaskList(),e.next=14;break;case 12:e.prev=12,e.t0=e.catch(3);case 14:case"end":return e.stop()}},e,t,[[3,12]])}))()},handleaTaskCurrentChange:function(t){this.taskListQuery.page_no=t,this._fetchSubTaskList()},handleSelectionChange:function(t){var e=this;this.taskCheckedList=[],t.forEach(function(t){e.taskCheckedList.push(t.id)})},handleSaveTaskList:function(){this.handleCloseDialog(),this.handleCloseAddTaskDialog()},handleDismissActivity:function(t){var e=this;console.log(t),this.$confirm("确认撤销该活动？").then(function(){var a=m()(p.a.mark(function a(i){return p.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(y.g)(t.id);case 2:return a.next=4,e._fetchActivityList();case 4:e.$message({message:"撤销成功",type:"success"});case 5:case"end":return a.stop()}},a,e)}));return function(t){return a.apply(this,arguments)}}()).catch(function(t){})},handleCloseAddTaskDialog:function(){this.dialogFormVisible=!1,this.dialogAddTaskVisible=!1},handleCloseTaskList:function(){this.dialogTaskList=!1,this.taskListQuery={page_no:1,page_size:10},this.taskCheckedList=[]},handleOpenSubjectList:function(){var t=this;return m()(p.a.mark(function e(){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._fetchSubTaskList();case 2:t.dialogTaskList=!0;case 3:case"end":return e.stop()}},e,t)}))()},handleCurrentChange:function(t){this.listQuery.page_no=t,this._fetchActivityList()},handleSizeChange:function(t){this.listQuery.page_size=t,this._fetchActivityList()},taskTypeChange:function(t){this.taskInfo.answer_type="1",this.taskInfo.answer_limit=1},answerTypeChange:function(t){"4"===t&&(this.taskInfo.answer_limit=1),this.taskInfo.limit_time=""},handleCheckedChange:function(t){t&&(this.activityInfo.keepTime="")},handleImgChange:function(t){var e=this;return m()(p.a.mark(function a(){var i,n,s,l,c,u,d,f,m,h,y;return p.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:e.is_progress=!0,i={},n=document.querySelector("#ImgInput"),s=n.files.length,l={headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(t){e.jindu=t.loaded/t.total*100|0,console.log(t.loaded/t.total*100|0)}},0,c=p.a.mark(function a(n){var o,c,u,d,f;return p.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return o=n.type.split("/")[1],c="top-team"+Date.now()+100*Math.random()+"."+o,a.next=4,e._fetchQiNiuToken();case 4:if(u=a.sent,(d=new FormData).append("token",u),d.append("key",c),f=e,!(/image\/\w+/.test(n.type)&&n.size>1024e3)){a.next=13;break}e.photoCompress(n,{quality:.2},function(e){var a=f.convertBase64UrlToBlob(e);a.uid=n.uid,a.name=n.name,a.uid=n.uid,a.lastModified=n.lastModified,a.lastModifiedDate=n.lastModifiedDate,a.webkitRelativePath=n.webkitRelativePath,d.append("file",a),I.a.post("http://upload.qiniup.com/",d,l).then(function(e){var a=f.qiniuAddress+"/"+e.data.key,o=n.name.split(".")[0];i[o]=a,v()(i).length===s&&I.a.post("/i/topteam/admin/MatchTaskPic",{activity_id:f.activityId,match_list:r()(i)}).then(function(e){e.data.error_code?f.$message({message:e.data.error_msg,type:"error"}):(f.$message({message:"上传成功",type:"success"}),f._fetchTaskList(f.activityId)),t.target.value=""}),f.is_progress=!1,f.jindu=0})}),a.next=24;break;case 13:return d.append("file",n),a.prev=14,a.next=17,I.a.post("http://upload.qiniup.com/",d,l).then(function(a){var o=e.qiniuAddress+"/"+a.data.key,l=n.name.split(".")[0];i[l]=o,v()(i).length===s&&I.a.post("/i/topteam/admin/MatchTaskPic",{activity_id:e.activityId,match_list:r()(i)}).then(function(a){a.data.error_code?e.$message({message:a.data.error_msg,type:"error"}):(e.$message({message:"上传成功",type:"success"}),e._fetchTaskList(e.activityId)),t.target.value=""}),e.is_progress=!1,e.jindu=0});case 17:a.next=24;break;case 19:a.prev=19,a.t0=a.catch(14),console.log(a.t0),t.target.value="",e.$message({message:"有图片上传失败，请重新上传全部图片",type:"error"});case 24:case"end":return a.stop()}},a,e,[[14,19]])}),u=!0,d=!1,f=void 0,a.prev=10,m=o()(n.files);case 12:if(u=(h=m.next()).done){a.next=18;break}return y=h.value,a.delegateYield(c(y),"t0",15);case 15:u=!0,a.next=12;break;case 18:a.next=24;break;case 20:a.prev=20,a.t1=a.catch(10),d=!0,f=a.t1;case 24:a.prev=24,a.prev=25,!u&&m.return&&m.return();case 27:if(a.prev=27,!d){a.next=30;break}throw f;case 30:return a.finish(27);case 31:return a.finish(24);case 32:case"end":return a.stop()}},a,e,[[10,20,24,32],[25,,27,31]])}))()},handleRemove:function(t,e){this.taskAFileList=e},handleActivityChange:function(t){"2"===t?(this.activityInfo.price=10,this.activityInfo.answer_limit=1,this.activityInfo.scoreType="1"):(this.needCoach="1",this.longTime="2",this.needTpl="2"),this.activityInfo.check=!1,this.activityInfo.coachId=null,this.activityInfo.tplId=null},handleFileChange:function(t){var e=this;this.is_progress=!0;var a=this.activityId,i=document.querySelector("#fileInput"),n=new FormData,s={headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(t){e.jindu=t.loaded/t.total*100|0}};n.append("file",i.files[0]),n.append("activity_id",a),I.a.post("/i/topteam/admin/importTask",n,s).then(function(i){var n=i.data;0!==n.error_code?(e.$message({message:n.error_msg,type:"error"}),t.target.value=""):(e.$message({message:"导入成功",type:"success"}),t.target.value="",e._fetchTaskList(a)),e.is_progress=!1,e.jindu=0})},handleFilter:function(){this.listQuery.page_no=1,this._fetchActivityList()},handleCreateActivity:function(){this.dialogFormVisible=!0,this.dialogActivityTitle="新增活动",this.dialogActivitytype="add"},handleBgCardPreview:function(){this.dialogImageUrl=this.activityInfo.bgImgUrl,this.dialogVisible=!0},handleIconCardPreview:function(){this.dialogImageUrl=this.activityInfo.iconUrl,this.dialogVisible=!0},handleGifCardPreview:function(){this.dialogImageUrl=this.activityInfo.gif_url,this.dialogVisible=!0},handleTaskImgPreview:function(){this.dialogTaskImageUrl=this.taskInfo.question_img,this.dialogTaskImgVisible=!0},handleAnswerImgPreview:function(){this.dialogAnswerImageUrl=this.taskInfo.answer_url,this.dialogAnswerImgVisible=!0},handleNineImgPreview:function(t){this.nineImageUrl=t.url,this.dialogNineVisible=!0},handleUpLoadBgImg:function(t){this._uploadQiNiu(t,"bgImg")},handleUpLoadIconImg:function(t){this._uploadQiNiu(t,"icon")},handleUpLoadGifImg:function(t){this._uploadQiNiu(t,"gif")},handleUpLoadTaksImg:function(t){this._uploadQiNiu(t,"task")},handleUpLoadAnswerImg:function(t){this._uploadQiNiu(t,"answer")},handleUpLoadNineImg:function(t){this._uploadQiNiu(t,"nine")},handelUpdateTaskSubmit:function(){var t=this;return m()(p.a.mark(function e(){var a,i,s,o,l,c,u;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.taskInfo,i=a.name,s=a.score,o=a.seq,l=a.answer_limit,i&&s&&o&&l){e.next=4;break}return t.$message({message:"必填项不能为空",type:"error"}),e.abrupt("return");case 4:if(c=n()({},t.taskInfo),Array.isArray(c.answer)&&(c.answer=r()(c.answer.sort())),"1"!==c.type){e.next=15;break}if(u=!1,v()(c.options).forEach(function(t){c.options[t]||(u=!0)}),!u){e.next=12;break}return t.$message({message:"选项不能为空",type:"error"}),e.abrupt("return");case 12:if("[]"!==c.answer){e.next=15;break}return t.$message({message:"请填写答案",type:"error"}),e.abrupt("return");case 15:if("3"!==c.type){e.next=24;break}if(c.options=[],t.taskAFileList.forEach(function(t){c.options.push(t.url)}),!(c.options.length<9)){e.next=21;break}return t.$message({message:"请上传九张图片",type:"error"}),e.abrupt("return");case 21:if("[]"!==c.answer){e.next=24;break}return t.$message({message:"请填写答案",type:"error"}),e.abrupt("return");case 24:if(c.options=r()(c.options),"2"!==c.type){e.next=30;break}if(c.answer2){e.next=29;break}return t.$message({message:"答案不能为空",type:"error"}),e.abrupt("return");case 29:c.answer=c.answer2;case 30:if("4"!==c.type){e.next=35;break}if(c.answer_url){e.next=34;break}return t.$message({message:"请上传视频",type:"error"}),e.abrupt("return");case 34:c.answer=c.answer_url;case 35:if("5"!==c.type){e.next=40;break}if(c.answer_url){e.next=39;break}return t.$message({message:"请上音频",type:"error"}),e.abrupt("return");case 39:c.answer=c.answer_url;case 40:if("6"!==c.type){e.next=45;break}if(c.answer_url){e.next=44;break}return t.$message({message:"请上传拍照图片",type:"error"}),e.abrupt("return");case 44:c.answer=c.answer_url;case 45:return c.limit_time||delete c.limit_time,e.prev=46,e.next=49,Object(y.p)(r()(c));case 49:e.sent,t.$message({message:"修改成功",type:"success"}),t.dialogTaskVisible=!1,t._fetchTaskList(t.activityId),e.next=57;break;case 55:e.prev=55,e.t0=e.catch(46);case 57:case"end":return e.stop()}},e,t,[[46,55]])}))()},handleUpdateTask:function(t){var e=this;this.dialogTaskType="edit",this.dialogTaskTitle="修改任务",this.dialogTaskVisible=!0,this.taskInfo.id=t.id,this.taskInfo.name=t.name,this.taskInfo.type=t.type,this.taskInfo.desc=t.task_desc,this.taskInfo.score=t.score,this.taskInfo.seq=t.seq,this.taskInfo.answer_limit=t.answer_limit,this.taskInfo.answer_type=t.answer_type,this.taskInfo.limit_time=t.limit_time,this.$set(this.taskInfo,"classification",t.classification),this.$set(this.taskInfo,"location_point",t.location_point),t.question_img&&(this.taskInfo.question_img=t.question_img,this.taskQFileList=[{name:t.name,url:t.question_img}]),"1"===t.type&&(this.taskInfo.answer=JSON.parse(t.answer),this.taskInfo.options=JSON.parse(t.options)),"2"===t.type&&(this.taskInfo.answer2=t.answer),"3"===t.type&&(this.taskInfo.answer=JSON.parse(t.answer||"[]"),this.taskInfo.options=JSON.parse(t.options),this.taskInfo.options.forEach(function(t,a){e.taskAFileList.push({name:"图片"+(a+1),url:t})})),"4"!==t.type&&"5"!==t.type&&"6"!==t.type||(this.taskInfo.answer_url=t.answer,this.taskInfo.answer_url&&(this.taskAFileList=[{name:t.name,url:t.answer}]))},handleGobackActivityList:function(){this.handleClosePayDialog(),this.handleCloseCheckDialog()},handleGetPayEr:function(){var t=this;return m()(p.a.mark(function e(){var a,i,n;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=void 0,"1"===t.checkInfo.type?a="team":"2"===t.checkInfo.type&&(a="person"),e.next=4,Object(y.j)({type_id:t.activityId,order_type:a});case 4:if(i=e.sent,n=i.data,"1"!==t.payType){e.next=10;break}t.pay_er_img="/i/topteam/api/getpayinfo?order_sn="+n.order_sn+"&pay_type=1",e.next=21;break;case 10:if("4"!==t.payType){e.next=21;break}return e.prev=11,e.next=14,Object(y.A)({order_sn:n.order_sn,pay_type:t.payType});case 14:e.sent,t.$message({message:"支付成功",type:"success"}),t.handleGobackActivityList(),e.next=21;break;case 19:e.prev=19,e.t0=e.catch(11);case 21:case"end":return e.stop()}},e,t,[[11,19]])}))()},handleCheckPass:function(){this.dialogPayVisible=!0},handleClosePayDialog:function(){this.dialogPayVisible=!1,this.pay_er_img="",this.payType="1"},handelAuditact:function(){this.dialogReasonVisible=!0},handleUpdateActivity:function(){var t=this;return m()(p.a.mark(function e(){var a,i,s,o,l,r,c,u,d,f,m,h,v,y,g,_,b,k;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.dialogActivityTitle="修改活动",t.dialogFormVisible=!0,t.dialogActivitytype="edit",a=t.activity,i=a.agent_name,s=a.agent_id,o=a.act_desc,l=a.set_start_time,r=a.score,c=a.set_stop_time,a.activity_status,u=a.type,d=a.coach_id,f=a.name,m=a.score_type,h=a.score_show_type,v=a.keep_time,y=a.money,g=a.bg_img,_=a.icon,b=a.gif_url,k=a.template_id,t.activityInfo.score=r,t.activityInfo.tplId=k,"0"!==k?t.needTpl="1":t.activityInfo.tplId=null,t.activityInfo.agentName=i,t.activityInfo.type=u,t.activityInfo.agent_id=s,t.activityInfo.coachId=d,t.activityInfo.name=f,t.activityInfo.scoreType=m,t.activityInfo.scoreShowType=h,t.activityInfo.keepTime=v,"0"===v&&(t.longTime="1",t.activityInfo.keepTime=""),t.activityInfo.price=y/100,t.activityInfo.time=[1e3*l,1e3*c],t.activityInfo.actDesc=o,t.activityInfo.bgImgUrl=g,g&&(t.bgFileList=[{name:"活动背景图",url:g}]),t.activityInfo.iconUrl=_,_&&(t.iconFilelist=[{name:"活动封面图",url:_}]),t.activityInfo.gif_url=b,b&&(t.gifFileList=[{name:"gif",url:b}]),"2"===t.activityInfo.type&&(t.activityInfo.scoreShowType=null),"0"===t.activityInfo.coachId&&(t.activityInfo.coachId=null),t.activityInfo=n()({},t.activityInfo);case 28:case"end":return e.stop()}},e,t)}))()},handleEditActivity:function(t){var e=this;return m()(p.a.mark(function a(){var i,n,s,o,l,r,c,u;return p.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e.activityId=t.id,a.next=3,Object(y.q)({act_id:t.id});case 3:return i=a.sent,a.next=6,e._fetchTaskList(t.id);case 6:n=i.data,e.activity=n,s=n.name,o=n.type,l=n.set_start_time,r=n.set_stop_time,c=n.money,u=n.qcode_url,e.checkInfo={name:s,type:o,money:c,qcode_url:u},e.checkInfo.set_start_time=l,e.checkInfo.set_stop_time=r,e.dialogCheckVisible=!0,e.dialogTitle="活动修改",e.dialogType="edit";case 15:case"end":return a.stop()}},a,e)}))()},handleShowActivityInfo:function(t){var e=this;return m()(p.a.mark(function a(){var i,n,s,o,l,r,c,u;return p.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e.activityId=t.id,a.next=3,Object(y.q)({act_id:t.id});case 3:return i=a.sent,a.next=6,e._fetchTaskList(t.id);case 6:n=i.data,s=n.name,o=n.type,l=n.set_start_time,r=n.set_stop_time,c=n.money,u=n.qcode_url,e.checkInfo={name:s,type:o,set_start_time:l,set_stop_time:r,money:c,qcode_url:u},e.dialogCheckVisible=!0,e.dialogTitle="活动查看",e.dialogType="show";case 12:case"end":return a.stop()}},a,e)}))()},handleCheckActivity:function(t){var e=this;return m()(p.a.mark(function a(){var i,n,s,o,l,r,c;return p.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e.activityId=t.id,a.next=3,Object(y.q)({act_id:t.id});case 3:return i=a.sent,a.next=6,e._fetchTaskList(t.id);case 6:n=i.data,s=n.name,o=n.type,l=n.set_start_time,r=n.set_stop_time,c=n.money,e.checkInfo={name:s,type:o,set_start_time:l,set_stop_time:r,money:c},e.dialogCheckVisible=!0,e.dialogTitle="活动审批",e.dialogType="check";case 12:case"end":return a.stop()}},a,e)}))()},handleCreateActivitySubmit:function(){this._addActivity()},handleCloseReasonDialog:function(){this.dialogReasonVisible=!1,this.reason=""},handleCloseDialog:function(t){this.dialogFormDisable=!1,t||("add"===this.dialogActivitytype&&(this.activityId=null,this.taskList=[],this._resetActivityInfo(),this._fetchActivityList()),"edit"===this.dialogActivitytype&&this._resetActivityInfo())},handleOpenTaskDialog:function(){this.dialogTaskType="add",this.dialogTaskTitle="添加任务",this.dialogTaskVisible=!0,this.taskInfo.options={A:null,B:null,C:null,D:null}},handleCloseTaskDialog:function(){this._resetTaskInfo(),this.dialogTaskVisible=!1,this.locationName1=""},handleCloseCheckDialog:function(){this.dialogCheckVisible=!1,this.activityId=null,this.taskList=[],this._resetActivityInfo(),this._restCheckInfo(),this._fetchActivityList()},handleDeleteActivity:function(t){var e=this;this.$confirm("确认删除该活动？").then(function(){var a=m()(p.a.mark(function a(i){return p.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(y.o)(t);case 2:return a.next=4,e._fetchActivityList();case 4:e.$message({message:"删除成功",type:"success"});case 5:case"end":return a.stop()}},a,e)}));return function(t){return a.apply(this,arguments)}}()).catch(function(t){})},handleClickTask:function(t){var e=this;this.$confirm("确认删除该任务？").then(function(){var a=m()(p.a.mark(function a(i){return p.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(y.m)(t);case 2:return a.next=4,e._fetchTaskList(e.activityId);case 4:e.$message({message:"删除成功",type:"success"});case 5:case"end":return a.stop()}},a,e)}));return function(t){return a.apply(this,arguments)}}()).catch(function(t){})},handleCancelActivity:function(){var t=this;this.$confirm("确认不通过该活动？").then(function(){var e=m()(p.a.mark(function e(a){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(y.f)({activity_id:t.activityId,reason:t.reason});case 2:return t.handleCloseReasonDialog(),t.handleCloseCheckDialog(),e.next=6,t._fetchActivityList();case 6:t.$message({message:"审批成功",type:"success"});case 7:case"end":return e.stop()}},e,t)}));return function(t){return e.apply(this,arguments)}}()).catch(function(t){})},canvasDataURL:function(t,e,a){var i=new Image;i.src=t,i.onload=function(){var t=this.width,i=this.height,n=t/i;t=e.width||t,i=e.height||t/n;var s=.7,o=document.createElement("canvas"),l=o.getContext("2d"),r=document.createAttribute("width");r.nodeValue=t;var c=document.createAttribute("height");c.nodeValue=i,o.setAttributeNode(r),o.setAttributeNode(c),l.drawImage(this,0,0,t,i),e.quality&&e.quality<=1&&e.quality>0&&(s=e.quality);var u=o.toDataURL("image/jpeg",s);a(u)}},photoCompress:function(t,e,a){var i=new FileReader;i.readAsDataURL(t);var n=this;i.onload=function(){var t=this.result;n.canvasDataURL(t,e,a)}},convertBase64UrlToBlob:function(t){for(var e=t.split(","),a=e[0].match(/:(.*?);/)[1],i=atob(e[1]),n=i.length,s=new Uint8Array(n);n--;)s[n]=i.charCodeAt(n);return new Blob([s],{type:a})},_uploadQiNiu:function(t,e){var a=this;return m()(p.a.mark(function i(){var n,s,o,l,r,c;return p.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a.is_progress=!0,n={headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(t){a.jindu=t.loaded/t.total*100|0}},s=t.file.type.split("/")[1],o="top-team"+Date.now()+Math.floor(100*Math.random())+"."+s,i.next=6,a._fetchQiNiuToken();case 6:l=i.sent,(r=new FormData).append("token",l),r.append("key",o),c=a,t.file.size/1024<1025?a.photoCompress(t.file,{quality:.2},function(a){var i=c.convertBase64UrlToBlob(a);i.uid=t.file.uid,i.name=t.file.name,i.uid=t.file.uid,i.lastModified=t.file.lastModified,i.lastModifiedDate=t.file.lastModifiedDate,i.webkitRelativePath=t.file.webkitRelativePath,r.append("file",i),I.a.post("http://upload.qiniup.com/",r,n).then(function(t){var a=c.qiniuAddress+"/"+t.data.key;"bgImg"===e&&(c.activityInfo.bgImgUrl=a),"icon"===e&&(c.activityInfo.iconUrl=a),"gif"===e&&(c.activityInfo.gif_url=a),"task"===e&&(c.taskInfo.question_img=a),"answer"===e&&(c.taskInfo.answer_url=a),"nine"===e&&c.taskAFileList.push({name:t.data.key.slice(0,23),url:a}),c.is_progress=!1,c.jindu=0})}):(r.append("file",t.file),I.a.post(a.domain,r,n).then(function(t){var i=a.qiniuAddress+"/"+t.data.key;"bgImg"===e&&(a.activityInfo.bgImgUrl=i),"icon"===e&&(a.activityInfo.iconUrl=i),"gif"===e&&(a.activityInfo.gif_url=i),"task"===e&&(a.taskInfo.question_img=i),"answer"===e&&(a.taskInfo.answer_url=i),"nine"===e&&a.taskAFileList.push({name:t.data.key.slice(0,23),url:i}),a.is_progress=!1,a.jindu=0}));case 12:case"end":return i.stop()}},i,a)}))()},_fetchCoachList:function(){var t=this;return m()(p.a.mark(function e(){var a,i;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(y.s)();case 2:a=e.sent,i=a.data,t.coachList=i;case 5:case"end":return e.stop()}},e,t)}))()},_fetchQiNiuToken:function(){var t=this;return m()(p.a.mark(function e(){var a,i;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(_.c)();case 2:return a=t.sent,i=a.data,t.abrupt("return",i);case 5:case"end":return t.stop()}},e,t)}))()},handleUpdateActivitySubmit:function(){var t=this;return m()(p.a.mark(function e(){var a,i,n,s,o,l,r,c,u,d,f,m,h,v,g,_,b,k,w,I,x,T,C,L,S;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a={},i=t.activityInfo,n=i.time,s=i.name,o=i.keepTime,l=i.score,r=i.coachId,c=i.actDesc,u=i.scoreType,d=i.scoreShowType,f=i.type,m=i.bgImgUrl,h=i.iconUrl,v=i.price,i.check,g=i.gif_url,_=i.agent_id,b=i.tplId,"1"!==f){e.next=8;break}if(n.length&&s&&o&&l&&r&&f){e.next=6;break}return t.$message({message:"必填项不能为空",type:"error"}),e.abrupt("return");case 6:e.next=12;break;case 8:if(n.length&&s&&f&&m&&h){e.next=11;break}return t.$message({message:"必填项不能为空",type:"error"}),e.abrupt("return");case 11:a.gif_url=g;case 12:return a.set_start_time=n[0]/1e3,a.set_stop_time=n[1]/1e3,a.agent_id=_,a.act_id=t.activityId,a.name=s,a.keep_time=o,a.score=l,a.coach_id=r||0,a.act_desc=c,a.score_type=u,a.score_show_type=d,a.type=f,a.bg_img=m,a.icon=h,a.money=v,"1"===t.longTime&&(a.keep_time=0),a.template_id=b||0,"2"===a.type&&(a.score=0,a.score_show_type=0),"1"===a.type&&(a.money=0),e.prev=31,e.next=34,Object(y.H)(a);case 34:return t.dialogFormDisable=!0,t.dialogAddTaskVisible=!0,t.handleCloseDialog(!0),t.$message({message:"修改成功",type:"success"}),e.next=40,Object(y.q)({act_id:a.act_id});case 40:k=e.sent,w=k.data,I=w.name,x=w.type,T=w.set_start_time,C=w.set_stop_time,L=w.money,S=w.qcode_url,t.checkInfo={name:I,type:x,money:L,qcode_url:S},t.set_start_time=1e3*T,t.set_stop_time=1e3*C,t.checkInfo.set_start_time=T,t.checkInfo.set_stop_time=C,e.next=51;break;case 49:e.prev=49,e.t0=e.catch(31);case 51:case"end":return e.stop()}},e,t,[[31,49]])}))()},_addActivity:function(){var t=this;return m()(p.a.mark(function e(){var a,i,n,s,o,l,r,c,u,d,f,m,h,v,g,_,k;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a={},i=t.activityInfo,n=i.time,s=i.name,o=i.keepTime,l=i.score,r=i.coachId,c=i.actDesc,u=i.scoreType,d=i.scoreShowType,f=i.type,m=i.bgImgUrl,h=i.iconUrl,v=i.price,i.check,g=i.gif_url,_=i.tplId,"1"!==f){e.next=8;break}if(n.length&&s&&o&&l&&r&&f){e.next=6;break}return t.$message({message:"必填项不能为空",type:"error"}),e.abrupt("return");case 6:e.next=12;break;case 8:if(n.length&&s&&f&&v&&m&&h){e.next=11;break}return t.$message({message:"必填项不能为空",type:"error"}),e.abrupt("return");case 11:a.gif_url=g;case 12:return a.set_start_time=n[0]/1e3,a.set_stop_time=n[1]/1e3,a.agent_id=Object(b.a)(),a.name=s,a.keep_time=o,a.score=l,a.coach_id=r||0,a.act_desc=c,a.score_type=u,a.score_show_type=d,a.type=f,a.bg_img=m,a.icon=h,a.money=v,"1"===t.longTime&&(a.keep_time=0),_?a.template_id=_:a.tplId=0,"2"===a.type&&(a.score=0,a.score_show_type=0),"1"===a.type&&(a.money=0),e.prev=30,e.next=33,Object(y.a)(a);case 33:return k=e.sent,t.dialogFormDisable=!0,t.activityId=k.data,e.next=38,t._fetchTaskList(k.data);case 38:t.$message({message:"创建成功",type:"success"}),t.handleCloseDialog(!0),t.dialogAddTaskVisible=!0,e.next=45;break;case 43:e.prev=43,e.t0=e.catch(30);case 45:case"end":return e.stop()}},e,t,[[30,43]])}))()},handelCreateTaskSubmit:function(){var t=this;return m()(p.a.mark(function e(){var a,i,s,o,l,c,u;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.activityId,i=t.taskInfo,s=i.name,o=i.score,l=i.seq,s&&o&&l){e.next=5;break}return t.$message({message:"必填项不能为空",type:"error"}),e.abrupt("return");case 5:if((c=n()({},t.taskInfo,{activity_id:a})).answer=r()(c.answer),"1"!==c.type){e.next=16;break}if(u=!1,v()(c.options).forEach(function(t){c.options[t]||(u=!0)}),!u){e.next=13;break}return t.$message({message:"选项不能为空",type:"error"}),e.abrupt("return");case 13:if("[]"!==c.answer){e.next=16;break}return t.$message({message:"请填写答案",type:"error"}),e.abrupt("return");case 16:if("3"!==c.type){e.next=25;break}if(c.options=[],t.taskAFileList.forEach(function(t){c.options.push(t.url)}),!(c.options.length<9)){e.next=22;break}return t.$message({message:"请上传九张图片",type:"error"}),e.abrupt("return");case 22:if("[]"!==c.answer){e.next=25;break}return t.$message({message:"请填写答案",type:"error"}),e.abrupt("return");case 25:if(c.options=r()(c.options),"2"!==c.type){e.next=31;break}if(c.answer2){e.next=30;break}return t.$message({message:"答案不能为空",type:"error"}),e.abrupt("return");case 30:c.answer=c.answer2;case 31:if("4"!==c.type){e.next=36;break}if(c.answer_url){e.next=35;break}return t.$message({message:"请上传视频",type:"error"}),e.abrupt("return");case 35:c.answer=c.answer_url;case 36:if("5"!==c.type){e.next=41;break}if(c.answer_url){e.next=40;break}return t.$message({message:"请上传音频",type:"error"}),e.abrupt("return");case 40:c.answer=c.answer_url;case 41:if("6"!==c.type){e.next=46;break}if(c.answer_url){e.next=45;break}return t.$message({message:"请上传拍照图片",type:"error"}),e.abrupt("return");case 45:c.answer=c.answer_url;case 46:return c.limit_time||delete c.limit_time,e.prev=47,e.next=50,Object(y.d)(r()(c));case 50:e.sent,t.$message({message:"添加成功",type:"success"}),t.dialogTaskVisible=!1,t._fetchTaskList(a),e.next=58;break;case 56:e.prev=56,e.t0=e.catch(47);case 58:case"end":return e.stop()}},e,t,[[47,56]])}))()},_fetchActivityList:function(){var t=this;return m()(p.a.mark(function e(){var a,i,s;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.listLoading=!0,e.prev=1,!(a=n()({},t.listQuery)).person_coach&&(a.person_coach=0),e.next=6,Object(y.r)(a);case 6:i=e.sent,s=i.data,t.listLoading=!1,t.list=s.list,t.total=s.total,e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),t.listLoading=!1;case 16:case"end":return e.stop()}},e,t,[[1,13]])}))()},_fetchTaskList:function(t){var e=this;return m()(p.a.mark(function a(){var i,n;return p.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(y.v)({activity_id:t});case 2:i=a.sent,(n=i.data)||(n=[]),e.taskList=n;case 6:case"end":return a.stop()}},a,e)}))()},_resetActivityInfo:function(){this.activityInfo={agentName:Object(b.b)(),type:"",coachId:"",name:"",keepTime:"",score:"",scoreType:"",scoreShowType:"",time:"",actDesc:"",bgImgUrl:"",iconUrl:"",price:"",check:"",gif_url:""},this.iconFilelist=[],this.bgFileList=[],this.gifFileList=[]},_resetTaskInfo:function(){this.taskInfo={name:null,type:"1",desc:null,answer_type:"1",seq:null,question_img:null,options:{},answer:[],answer2:"",answer_url:"",score:null,answer_limit:1,limit_time:"",classification:"0",location_point:""},this.chooseLocation=[],this.taskQFileList=[],this.taskAFileList=[]},_restCheckInfo:function(){this.checkInfo={name:null,activity_status:null,set_start_time:null,set_stop_time:null,money:null},this.set_start_time="",this.set_stop_time=""},_fetchSubTaskList:function(){var t=this;return m()(p.a.mark(function e(){var a,i,s;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=n()({},t.taskListQuery),"2"===t.activityInfo.type&&(a.activity_type="1"),"2"===t.activityInfo.type&&t.activityInfo.coachId&&(a.activity_type="2"),console.log(a),e.next=6,Object(y.u)(a);case 6:i=e.sent,s=i.data,t.tasklistData=s.list,t.taskTotal=s.total;case 10:case"end":return e.stop()}},e,t)}))()},_fetchTaskClassify:function(){var t=this;return m()(p.a.mark(function e(){var a;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(y.D)();case 2:a=e.sent,t.taskClassfiyList=a.data.list;case 4:case"end":return e.stop()}},e,t)}))()},_getTemplateList:function(){var t=this;return m()(p.a.mark(function e(){var a;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(g.n)({page_no:1,page_size:1e3});case 2:a=e.sent,t.tplList=a.data.list;case 4:case"end":return e.stop()}},e,t)}))()},init:function(){this._fetchCoachList(),this._fetchActivityList(),this._fetchTaskClassify(),this._getTemplateList()}}}),C=(a("hoD4"),a("KHd+")),L=Object(C.a)(T,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"请输入运营商名称"},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.handleFilter(e):null}},model:{value:t.listQuery.agent_name,callback:function(e){t.$set(t.listQuery,"agent_name",e)},expression:"listQuery.agent_name"}}),t._v(" "),a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"请输入活动名称"},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.handleFilter(e):null}},model:{value:t.listQuery.name,callback:function(e){t.$set(t.listQuery,"name",e)},expression:"listQuery.name"}}),t._v(" "),a("el-select",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"请选择活动类型",clearable:""},on:{change:t.handleFilter},model:{value:t.listQuery.type,callback:function(e){t.$set(t.listQuery,"type",e)},expression:"listQuery.type"}},t._l(t.activities,function(t){return a("el-option",{key:t.key,attrs:{label:t.label,value:t.key}})})),t._v(" "),a("el-select",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"请选择活动状态",clearable:""},on:{change:t.handleFilter},model:{value:t.listQuery.status,callback:function(e){t.$set(t.listQuery,"status",e)},expression:"listQuery.status"}},t._l(t.status,function(t){return a("el-option",{key:t.key,attrs:{label:t.label,value:t.key}})})),t._v(" "),a("el-select",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"是否指定教练",clearable:""},on:{change:t.handleFilter},model:{value:t.listQuery.person_coach,callback:function(e){t.$set(t.listQuery,"person_coach",e)},expression:"listQuery.person_coach"}},[a("el-option",{key:"1",attrs:{label:"是",value:"1"}}),t._v(" "),a("el-option",{key:"2",attrs:{label:"否",value:"2"}})],1),t._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.handleFilter}},[t._v("查询")]),t._v(" "),t.showable?a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:t.handleCreateActivity}},[t._v("新增活动")]):t._e()],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:t.list,border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{label:"序号",align:"center",width:"65"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.$index+1))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"运营商",width:"150px",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.agent_name))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"活动名称","min-width":"130px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.name))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"游戏类型",width:"110px",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("activityFilter")(e.row.type)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"活动封面",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("img",{staticStyle:{display:"block",width:"40px",height:"40px",margin:"0 auto"},attrs:{src:t.row.icon,alt:""}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"活动时间",align:"center",width:"95"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.keep_time)+"分钟")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"初始分值",align:"center",width:"95"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.score))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"活动状态","class-name":"status-col",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("statusFilter")(e.row.activity_status)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center","min-width":"130","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){return["2"!==e.row.activity_status&&"6"!==e.row.activity_status&&"-1"!==e.row.activity_status||!t.showable?t._e():a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){t.handleEditActivity(e.row)}}},[t._v("修改")]),t._v(" "),"1"!==e.row.activity_status?a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(a){t.handleShowActivityInfo(e.row)}}},[t._v("查看")]):t._e(),t._v(" "),"1"===e.row.activity_status&&"2"===t.level?a("el-button",{attrs:{size:"mini"},on:{click:function(a){t.handleCheckActivity(e.row)}}},[t._v("去审批")]):t._e(),t._v(" "),"1"!==e.row.activity_status||"5"!==t.level&&"6"!==t.level?t._e():a("el-button",{attrs:{size:"mini"},on:{click:function(a){t.handleDismissActivity(e.row)}}},[t._v("撤销")]),t._v(" "),5===e.row.activity_status||"6"===e.row.activity_status?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){t.handleDeleteActivity(e.row.id)}}},[t._v("删除")]):t._e()]}}])})],1),t._v(" "),a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{"current-page":t.listQuery.page_no,"page-sizes":[10,20,30,50],"page-size":t.listQuery.page_size,total:t.total,background:"",layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),t._v(" "),a("el-dialog",{staticClass:"aDialog",attrs:{"close-on-click-modal":!1,visible:t.dialogFormVisible,title:t.dialogActivityTitle,top:"8vh"},on:{"update:visible":function(e){t.dialogFormVisible=e},close:t.handleCloseDialog}},[a("hr"),t._v(" "),a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.activityInfo,disabled:t.dialogFormDisable}},[a("el-form-item",{attrs:{label:"运营商名"}},[a("el-input",{staticStyle:{width:"195px"},attrs:{disabled:""},model:{value:t.activityInfo.agentName,callback:function(e){t.$set(t.activityInfo,"agentName",e)},expression:"activityInfo.agentName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"活动名称"}},[a("el-input",{staticStyle:{width:"195px"},model:{value:t.activityInfo.name,callback:function(e){t.$set(t.activityInfo,"name",e)},expression:"activityInfo.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"活动类型"}},[a("el-select",{attrs:{disabled:"edit"===t.dialogActivitytype},on:{change:t.handleActivityChange},model:{value:t.activityInfo.type,callback:function(e){t.$set(t.activityInfo,"type",e)},expression:"activityInfo.type"}},[a("el-option",{attrs:{label:"团队-基础版",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"个人-基础版",value:"2"}})],1)],1),t._v(" "),a("br"),t._v(" "),a("el-form-item",{attrs:{label:"起始分值"}},[a("el-input",{staticStyle:{width:"195px"},attrs:{disabled:!t.activityInfo.type||"2"===t.activityInfo.type,onkeypress:"return event.keyCode ? event.keyCode>=48 && event.keyCode<=57 : event.which >= 48 && event.which <= 57"},model:{value:t.activityInfo.score,callback:function(e){t.$set(t.activityInfo,"score",e)},expression:"activityInfo.score"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"可见分数"}},[a("el-select",{attrs:{disabled:!t.activityInfo.type||"2"===t.activityInfo.type},model:{value:t.activityInfo.scoreShowType,callback:function(e){t.$set(t.activityInfo,"scoreShowType",e)},expression:"activityInfo.scoreShowType"}},[a("el-option",{attrs:{label:"否",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"是",value:"2"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"分值形式"}},[a("el-select",{model:{value:t.activityInfo.scoreType,callback:function(e){t.$set(t.activityInfo,"scoreType",e)},expression:"activityInfo.scoreType"}},[a("el-option",{attrs:{label:"积分",value:"1"}}),t._v(" "),"1"===t.activityInfo.type?a("el-option",{attrs:{label:"钻石",value:"2"}}):t._e(),t._v(" "),"1"===t.activityInfo.type?a("el-option",{attrs:{label:"花瓣",value:"3"}}):t._e(),t._v(" "),"1"===t.activityInfo.type?a("el-option",{attrs:{label:"游戏币",value:"4"}}):t._e()],1)],1),t._v(" "),a("br"),t._v(" "),a("el-form-item",{attrs:{label:"需要教练"}},[a("el-select",{attrs:{disabled:"2"!==t.activityInfo.type},on:{change:function(e){t.activityInfo.coachId=null}},model:{value:t.needCoach,callback:function(e){t.needCoach=e},expression:"needCoach"}},[a("el-option",{attrs:{label:"是",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"否",value:"2"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"选择教练"}},[a("el-select",{attrs:{disabled:"edit"===t.dialogActivitytype&&!t.activityInfo.coachId||"2"===t.needCoach,clearable:!("edit"===t.dialogActivitytype&&t.activityInfo.coachId)},model:{value:t.activityInfo.coachId,callback:function(e){t.$set(t.activityInfo,"coachId",e)},expression:"activityInfo.coachId"}},t._l(t.coachList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),a("br"),t._v(" "),a("el-form-item",{attrs:{label:"长期活动"}},[a("el-select",{attrs:{disabled:"2"!==t.activityInfo.type},on:{change:function(e){t.activityInfo.keepTime=""}},model:{value:t.longTime,callback:function(e){t.longTime=e},expression:"longTime"}},[a("el-option",{attrs:{label:"是",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"否",value:"2"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"活动时长"}},[a("el-input",{attrs:{disabled:t.checkdisabled,onkeypress:"return event.keyCode ? event.keyCode>=48 && event.keyCode<=57 : event.which >= 48 && event.which <= 57"},model:{value:t.activityInfo.keepTime,callback:function(e){t.$set(t.activityInfo,"keepTime",e)},expression:"activityInfo.keepTime"}},[a("div",{attrs:{slot:"suffix"},slot:"suffix"},[t._v("\n            (分钟)\n          ")])])],1),t._v(" "),a("br"),t._v(" "),t.activityInfo.coachId&&"2"===t.activityInfo.type?a("el-form-item",{attrs:{label:"采集信息"}},[a("el-select",{attrs:{disabled:"2"!==t.activityInfo.type},on:{change:function(e){t.activityInfo.tplId=null}},model:{value:t.needTpl,callback:function(e){t.needTpl=e},expression:"needTpl"}},[a("el-option",{attrs:{label:"是",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"否",value:"2"}})],1)],1):t._e(),t._v(" "),t.activityInfo.coachId&&"2"===t.activityInfo.type?a("el-form-item",{attrs:{label:"信息模板"}},[a("el-select",{attrs:{disabled:"2"===t.needTpl},model:{value:t.activityInfo.tplId,callback:function(e){t.$set(t.activityInfo,"tplId",e)},expression:"activityInfo.tplId"}},t._l(t.tplList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1):t._e(),t._v(" "),"2"===t.activityInfo.type?a("el-form-item",{attrs:{label:"活动价格"}},[a("el-input",{attrs:{onkeypress:"return event.keyCode ? event.keyCode>=48 && event.keyCode<=57 : event.which >= 48 && event.which <= 57"},model:{value:t.activityInfo.price,callback:function(e){t.$set(t.activityInfo,"price",e)},expression:"activityInfo.price"}})],1):t._e(),t._v(" "),a("el-form-item",{attrs:{label:"起止时间"}},["2"!==t.activityInfo.type?a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"-","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"timestamp"},model:{value:t.activityInfo.time,callback:function(e){t.$set(t.activityInfo,"time",e)},expression:"activityInfo.time"}}):t._e(),t._v(" "),"2"===t.activityInfo.type?a("el-time-picker",{attrs:{"is-range":"","range-separator":"-","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"timestamp"},model:{value:t.activityInfo.time,callback:function(e){t.$set(t.activityInfo,"time",e)},expression:"activityInfo.time"}}):t._e()],1),t._v(" "),a("el-form-item",{attrs:{label:"活动描述"}},[a("el-input",{staticClass:"act-textarea",attrs:{autosize:{minRows:1},type:"textarea",maxlength:"300"},model:{value:t.activityInfo.actDesc,callback:function(e){t.$set(t.activityInfo,"actDesc",e)},expression:"activityInfo.actDesc"}})],1),t._v(" "),a("div",[a("el-form-item",{attrs:{label:"活动封面"}},[a("el-upload",{attrs:{"http-request":t.handleUpLoadIconImg,"on-preview":t.handleIconCardPreview,limit:1,action:t.domain,"file-list":t.iconFilelist,"list-type":"picture-card"}},[a("el-button",[t._v("上传图片")])],1),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("img",{attrs:{src:t.dialogImageUrl,width:"100%",alt:""}})])],1),t._v(" "),a("el-form-item",{attrs:{label:"活动背景"}},[a("el-upload",{attrs:{"http-request":t.handleUpLoadBgImg,"on-preview":t.handleBgCardPreview,limit:1,action:t.domain,"file-list":t.bgFileList,"list-type":"picture-card"}},[a("el-button",[t._v("上传图片")])],1)],1),t._v(" "),"2"===t.activityInfo.type?a("el-form-item",{attrs:{label:"活动提示"}},[a("el-upload",{attrs:{"http-request":t.handleUpLoadGifImg,"on-preview":t.handleGifCardPreview,limit:1,action:t.domain,"file-list":t.gifFileList,"list-type":"picture-card"}},[a("el-button",[t._v("上传图片")])],1)],1):t._e()],1),t._v(" "),a("div",{staticStyle:{textAlign:"center"}},["add"===t.dialogActivitytype?a("el-button",{attrs:{type:"primary"},on:{click:t.handleCreateActivitySubmit}},[t._v("创建活动并下一步")]):t._e(),t._v(" "),"edit"===t.dialogActivitytype?a("el-button",{attrs:{type:"primary"},on:{click:t.handleUpdateActivitySubmit}},[t._v("修改活动并下一步")]):t._e()],1)],1)],1),t._v(" "),a("el-dialog",{staticClass:"aDialog",attrs:{"close-on-click-modal":!1,visible:t.dialogAddTaskVisible,title:t.dialogActivityTitle,top:"8vh"},on:{"update:visible":function(e){t.dialogAddTaskVisible=e},close:t.handleCloseAddTaskDialog}},[a("div",{staticClass:"job-list"},[a("div",{staticClass:"job-title"},[a("h3",{staticStyle:{display:"inline-block"}},[t._v("任务列表")]),t._v(" "),a("div",{staticClass:"filePicker",staticStyle:{float:"right"}},[a("label",[t._v("导入任务")]),t._v(" "),a("input",{attrs:{id:"fileInput",type:"file",name:"file",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"},on:{change:t.handleFileChange}})]),t._v(" "),a("div",{staticClass:"filePicker",staticStyle:{float:"right","margin-right":"20px"}},[a("label",[t._v("导入图片")]),t._v(" "),a("input",{attrs:{id:"ImgInput",type:"file",name:"file",multiple:"",accept:"image/*,vedio/*,audio/*"},on:{change:t.handleImgChange}})]),t._v(" "),a("el-button",{staticStyle:{float:"right","margin-right":"20px"},attrs:{type:"primary"},on:{click:t.handleOpenTaskDialog}},[t._v("添加任务")]),t._v(" "),a("el-button",{staticStyle:{float:"right","margin-right":"20px"},attrs:{type:"success"},on:{click:t.handleOpenSubjectList}},[t._v("题库导入")])],1),t._v(" "),a("div",{staticClass:"job-table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.taskList,border:"",fit:"","highlight-current-row":"",height:"500"}},[a("el-table-column",{attrs:{label:"序号",align:"center",width:"65"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.$index+1))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"题目标题",width:"150px",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.name))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"描述","min-width":"130px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.task_desc))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"答案",width:"150px",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.answer))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"题目类型",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("typeFilter")(e.row.type)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"分值",align:"center",width:"95"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.score))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"答题类型",align:"center",width:"95"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("answerTypeFilter")(e.row.answer_type)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center","min-width":"230","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){t.handleChangeTaskSort(e.row,"up")}}},[t._v("上移")]),t._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(a){t.handleChangeTaskSort(e.row,"down")}}},[t._v("下移")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){t.handleUpdateTask(e.row)}}},[t._v("修改")])]}}])})],1)],1),t._v(" "),a("div",{staticStyle:{marginTop:"20px",textAlign:"center"}},[a("el-button",{attrs:{type:"primary"},on:{click:t.handleSaveTaskList}},[t._v("保存")])],1)])]),t._v(" "),a("el-dialog",{staticClass:"activityDialog",attrs:{"close-on-click-modal":!1,visible:t.dialogTaskVisible,title:t.dialogTaskTitle,top:"8vh"},on:{"update:visible":function(e){t.dialogTaskVisible=e},close:t.handleCloseTaskDialog}},[a("el-form",{staticClass:"demo-form-inline",attrs:{model:t.taskInfo}},[a("el-form-item",{attrs:{label:"题目标题","label-width":"100px"}},[a("el-input",{model:{value:t.taskInfo.name,callback:function(e){t.$set(t.taskInfo,"name",e)},expression:"taskInfo.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"题目类型","label-width":"100px"}},[a("el-select",{attrs:{disabled:"edit"===t.dialogTaskType},on:{change:t.taskTypeChange},model:{value:t.taskInfo.type,callback:function(e){t.$set(t.taskInfo,"type",e)},expression:"taskInfo.type"}},[a("el-option",{attrs:{label:"选择题",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"文字题",value:"2"}}),t._v(" "),a("el-option",{attrs:{label:"图片题",value:"3"}}),t._v(" "),t.activityInfo.coachId?a("el-option",{attrs:{label:"视频题",value:"4"}}):t._e(),t._v(" "),t.activityInfo.coachId?a("el-option",{attrs:{label:"语音题",value:"5"}}):t._e(),t._v(" "),t.activityInfo.coachId?a("el-option",{attrs:{label:"拍照题",value:"6"}}):t._e()],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"题目描述","label-width":"100px"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.taskInfo.desc,callback:function(e){t.$set(t.taskInfo,"desc",e)},expression:"taskInfo.desc"}})],1),t._v(" "),t.taskClassfiyList.length?a("el-form-item",{attrs:{label:"题目分类","label-width":"100px"}},[a("el-select",{model:{value:t.taskInfo.classification,callback:function(e){t.$set(t.taskInfo,"classification",e)},expression:"taskInfo.classification"}},[a("el-option",{attrs:{label:"默认",value:"0"}}),t._v(" "),t._l(t.taskClassfiyList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})],2)],1):t._e(),t._v(" "),a("el-form-item",{attrs:{label:"题目分值","label-width":"100px"}},[a("el-input",{attrs:{type:"number"},model:{value:t.taskInfo.score,callback:function(e){t.$set(t.taskInfo,"score",e)},expression:"taskInfo.score"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"答题类型","label-width":"100px"}},[a("el-select",{attrs:{disabled:"edit"===t.dialogTaskType},on:{change:t.answerTypeChange},model:{value:t.taskInfo.answer_type,callback:function(e){t.$set(t.taskInfo,"answer_type",e)},expression:"taskInfo.answer_type"}},[a("el-option",{attrs:{label:"普通题",value:"1"}}),t._v(" "),"1"===t.taskInfo.type||"2"===t.taskInfo.type||"3"===t.taskInfo.type?a("el-option",{attrs:{label:"关卡题",value:"2"}}):t._e(),t._v(" "),!t.activityInfo.coachId||"1"!==t.taskInfo.type&&"2"!==t.taskInfo.type&&"3"!==t.taskInfo.type?t._e():a("el-option",{attrs:{label:"限时题",value:"3"}}),t._v(" "),!t.activityInfo.coachId||"1"!==t.taskInfo.type&&"2"!==t.taskInfo.type&&"3"!==t.taskInfo.type?t._e():a("el-option",{attrs:{label:"抢答题",value:"4"}})],1)],1),t._v(" "),"3"===t.taskInfo.answer_type?a("el-form-item",{attrs:{label:"答题时间","label-width":"100px"}},[a("el-input",{attrs:{type:"number"},model:{value:t.taskInfo.limit_time,callback:function(e){t.$set(t.taskInfo,"limit_time",e)},expression:"taskInfo.limit_time"}},[a("div",{attrs:{slot:"suffix"},slot:"suffix"},[t._v("(秒)")])])],1):t._e(),t._v(" "),a("el-form-item",{attrs:{label:"题目顺序","label-width":"100px"}},[a("el-input",{attrs:{type:"number"},model:{value:t.taskInfo.seq,callback:function(e){t.$set(t.taskInfo,"seq",e)},expression:"taskInfo.seq"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"答题人数","label-width":"100px"}},[a("el-input",{attrs:{disabled:"2"===t.activityInfo.type||"4"===t.taskInfo.answer_type,type:"number"},model:{value:t.taskInfo.answer_limit,callback:function(e){t.$set(t.taskInfo,"answer_limit",e)},expression:"taskInfo.answer_limit"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"题目图片","label-width":"100px"}},[a("el-upload",{attrs:{"http-request":t.handleUpLoadTaksImg,"on-preview":t.handleTaskImgPreview,limit:1,action:t.domain,"file-list":t.taskQFileList,"list-type":"picture-card",accept:"image/jpeg,image/gif,image/png"}},[a("el-button",[t._v("上传图片")])],1),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogTaskImgVisible},on:{"update:visible":function(e){t.dialogTaskImgVisible=e}}},[a("img",{attrs:{src:t.dialogTaskImageUrl,width:"100%",alt:""}})])],1),t._v(" "),"1"===t.taskInfo.type?[a("el-form-item",{attrs:{label:"题目选项","label-width":"100px"}},[t._l(t.taskInfo.options,function(e,i){return a("el-input",{key:i,attrs:{placeholder:"请输入选项内容"},model:{value:t.taskInfo.options[i],callback:function(e){t.$set(t.taskInfo.options,i,e)},expression:"taskInfo.options[index]"}},[a("template",{staticStyle:{width:"51px"},slot:"prepend"},[t._v(t._s(i))]),t._v(" "),a("template",{slot:"suffix"},[i===t.lastKey?a("el-button",{staticStyle:{"margin-top":"4px"},attrs:{size:"mini",type:"primary"},on:{click:function(e){t.handleClickOption(i)}}},[t._v("删除")]):t._e()],1),t._v(" "),a("template",{slot:"append"},[a("el-checkbox",{attrs:{checked:-1!==t.taskInfo.answer.indexOf(i)},on:{change:function(e){t.handleCheckBoxChange(e,i)}}},[t._v("是否为正确答案")])],1)],2)}),t._v(" "),a("el-button",{staticStyle:{"margin-top":"10px"},on:{click:t.handleAddNewLine}},[t._v("添加一行")])],2)]:t._e(),t._v(" "),"2"===t.taskInfo.type?[a("el-form-item",{attrs:{label:"答案","label-width":"100px"}},[a("el-input",{model:{value:t.taskInfo.answer2,callback:function(e){t.$set(t.taskInfo,"answer2",e)},expression:"taskInfo.answer2"}})],1)]:t._e(),t._v(" "),"3"===t.taskInfo.type?[a("el-form-item",{attrs:{label:"九宫格图片","label-width":"100px"}},[a("el-upload",{attrs:{"http-request":t.handleUpLoadNineImg,"on-preview":t.handleNineImgPreview,"on-remove":t.handleRemove,limit:9,action:t.domain,"file-list":t.taskAFileList,multiple:"",accept:"image/jpeg,image/gif,image/png","list-type":"picture"}},[a("el-button",[t._v("上传图片")])],1),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogNineVisible},on:{"update:visible":function(e){t.dialogNineVisible=e}}},[a("img",{attrs:{src:t.nineImageUrl,width:"100%",alt:""}})])],1),t._v(" "),a("el-form-item",{attrs:{label:"答案","label-width":"100px"}},[a("el-checkbox-group",{model:{value:t.taskInfo.answer,callback:function(e){t.$set(t.taskInfo,"answer",e)},expression:"taskInfo.answer"}},[a("el-checkbox",{attrs:{label:"1"}}),t._v(" "),a("el-checkbox",{attrs:{label:"2"}}),t._v(" "),a("el-checkbox",{attrs:{label:"3"}}),t._v(" "),a("el-checkbox",{attrs:{label:"4"}}),t._v(" "),a("el-checkbox",{attrs:{label:"5"}}),t._v(" "),a("el-checkbox",{attrs:{label:"6"}}),t._v(" "),a("el-checkbox",{attrs:{label:"7"}}),t._v(" "),a("el-checkbox",{attrs:{label:"8"}}),t._v(" "),a("el-checkbox",{attrs:{label:"9"}})],1)],1)]:t._e(),t._v(" "),"4"===t.taskInfo.type?[a("el-form-item",{attrs:{label:"题目视频","label-width":"100px"}},[a("el-upload",{attrs:{"http-request":t.handleUpLoadAnswerImg,"on-preview":t.handleAnswerImgPreview,limit:1,action:t.domain,"file-list":t.taskAFileList,accept:"video/mp4,video/ogg,video/flv,video/avi,video/wmv,video/rmvb"}},[a("el-button",[t._v("上传视频")])],1),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogAnswerImgVisible},on:{"update:visible":function(e){t.dialogAnswerImgVisible=e}}},[a("video",{attrs:{src:t.dialogAnswerImageUrl,controls:"",autoplay:"",width:"100%"}})])],1)]:t._e(),t._v(" "),"5"===t.taskInfo.type?[a("el-form-item",{attrs:{label:"题目语音","label-width":"100px"}},[a("el-upload",{attrs:{"http-request":t.handleUpLoadAnswerImg,"on-preview":t.handleAnswerImgPreview,limit:1,action:t.domain,"file-list":t.taskAFileList,accept:"audio/*"}},[a("el-button",[t._v("上传音频")])],1),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogAnswerImgVisible},on:{"update:visible":function(e){t.dialogAnswerImgVisible=e}}},[a("video",{attrs:{src:t.dialogAnswerImageUrl,controls:"",autoplay:"",width:"100%"}})])],1)]:t._e(),t._v(" "),"6"===t.taskInfo.type?[a("el-form-item",{attrs:{label:"拍照图片","label-width":"100px"}},[a("el-upload",{attrs:{"http-request":t.handleUpLoadAnswerImg,"on-preview":t.handleAnswerImgPreview,limit:1,action:t.domain,"file-list":t.taskAFileList,"list-type":"picture-card",accept:"image/jpeg,image/gif,image/png"}},[a("el-button",[t._v("上传图片")])],1)],1),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogAnswerImgVisible},on:{"update:visible":function(e){t.dialogAnswerImgVisible=e}}},[a("img",{attrs:{src:t.dialogAnswerImageUrl,width:"100%",alt:""}})])]:t._e(),t._v(" "),a("el-form-item",{attrs:{label:"定位","label-width":"100px"}},[a("span",[t._v(t._s(t.locationName||t.locationName1))]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleOpenTenceMap}},[t._v("选择定位")]),t._v(" "),t.locationName1?a("el-button",{on:{click:t.handleDeleteLocation}},[t._v("删除定位")]):t._e(),t._v(" "),a("p",{staticStyle:{color:"#f573c1","margin-top":"0"}},[t._v("注：选择定位后，只有到达指定位置才能回答此题")])],1),t._v(" "),a("el-form-item",[a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{on:{click:t.handleCloseTaskDialog}},[t._v("取消")]),t._v(" "),"add"===t.dialogTaskType?a("el-button",{attrs:{type:"primary"},on:{click:t.handelCreateTaskSubmit}},[t._v("添加题目")]):t._e(),t._v(" "),"edit"===t.dialogTaskType?a("el-button",{attrs:{type:"primary"},on:{click:t.handelUpdateTaskSubmit}},[t._v("修改题目")]):t._e()],1)])],2)],1),t._v(" "),a("el-dialog",{staticClass:"activityDialog",attrs:{"close-on-click-modal":!1,visible:t.dialogCheckVisible,fullscreen:"",top:"8vh"},on:{"update:visible":function(e){t.dialogCheckVisible=e},close:t.handleCloseCheckDialog}},[a("hr"),t._v(" "),a("div",{attrs:{slot:"title"},slot:"title"},[a("h3",[t._v("\n        "+t._s(t.dialogTitle)+"\n        "),"check"===t.dialogType?a("el-button",{on:{click:t.handelAuditact}},[t._v("不通过")]):t._e(),t._v(" "),"check"===t.dialogType?a("el-button",{attrs:{type:"primary"},on:{click:t.handleCheckPass}},[t._v("通过")]):t._e()],1)]),t._v(" "),a("div",{staticClass:"info clearfix"},[a("div",{staticClass:"info-tab-left",staticStyle:{width:"50%",float:"left"}},[a("h4",[t._v("活动信息")]),t._v(" "),a("el-form",{model:{value:t.checkInfo,callback:function(e){t.checkInfo=e},expression:"checkInfo"}},[a("el-form-item",{attrs:{label:"活动名称","label-width":"100px"}},[a("span",[t._v(t._s(t.checkInfo.name))])]),t._v(" "),a("el-form-item",{attrs:{label:"活动类型","label-width":"100px"}},[a("span",[t._v(t._s(t._f("activityFilter")(t.checkInfo.type)))])]),t._v(" "),a("el-form-item",{attrs:{label:"开始时间","label-width":"100px"}},[a("span",[t._v(t._s(t._f("timeFilter")(t.checkInfo.set_start_time)))])]),t._v(" "),a("el-form-item",{attrs:{label:"结束时间","label-width":"100px"}},[a("span",[t._v(t._s(t._f("timeFilter")(t.checkInfo.set_stop_time)))]),t._v(" "),"edit"===t.dialogType?a("el-button",{attrs:{type:"primary"},on:{click:t.handleUpdateActivity}},[t._v("修改活动")]):t._e()],1)],1)],1),t._v(" "),a("div",{staticClass:"info-tab-right",staticStyle:{width:"50%",float:"right"}},[a("h4",[t._v("活动二维码")]),t._v(" "),a("div",{staticClass:"er-img",staticStyle:{width:"160px",height:"160px",margin:"0 auto",border:"1px solid #ccc","margin-top":"20px"}},[t.checkInfo.qcode_url?t._e():a("span",{staticStyle:{color:"red","font-size":"18px"}},[t._v("活动审批完成后创建二维码")]),t._v(" "),a("img",{staticStyle:{height:"158px",width:"158px"},attrs:{src:t.checkInfo.qcode_url,alt:""}}),t._v(" "),a("p",{staticStyle:{"text-align":"center",color:"red","font-weight":"500"}},[t._v(t._s(t.checkInfo.name))])])])]),t._v(" "),a("hr"),t._v(" "),a("div",{staticClass:"job-list"},[a("div",{staticClass:"job-title"},[a("h3",{staticStyle:{display:"inline-block"}},[t._v("任务列表")])]),t._v(" "),a("div",{staticClass:"job-table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.taskList,border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{label:"序号",align:"center",width:"65"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.$index+1))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"题目标题",width:"150px",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.name))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"描述","min-width":"130px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.task_desc))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"答案",width:"150px",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.answer))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"题目类型",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("typeFilter")(e.row.type)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"分值",align:"center",width:"95"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.score))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"答题类型",align:"center",width:"95"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("answerTypeFilter")(e.row.answer_type)))])]}}])}),t._v(" "),"edit"==t.dialogType?a("el-table-column",{attrs:{label:"操作",align:"center","min-width":"130","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary"},on:{click:function(a){t.handleUpdateTask(e.row)}}},[t._v("修改")]),t._v(" "),a("el-button",{attrs:{type:"danger"},on:{click:function(a){t.handleClickTask(e.row.id)}}},[t._v("删除")])]}}])}):t._e()],1)],1)])]),t._v(" "),a("el-dialog",{staticClass:"activityDialog",attrs:{"close-on-click-modal":!1,visible:t.dialogReasonVisible,title:"不通过原因"},on:{"update:visible":function(e){t.dialogReasonVisible=e},close:t.handleCloseReasonDialog}},[a("el-form",[a("el-form-item",[a("el-input",{attrs:{type:"textarea"},model:{value:t.reason,callback:function(e){t.reason=e},expression:"reason"}})],1),t._v(" "),a("el-form-item",[a("el-button",{on:{click:t.handleCloseReasonDialog}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleCancelActivity}},[t._v("确认")])],1)],1)],1),t._v(" "),a("el-dialog",{staticClass:"activityDialog",attrs:{"close-on-click-modal":!1,visible:t.dialogPayVisible,title:"活动付费(点击确定扫描右侧二维码)"},on:{"update:visible":function(e){t.dialogPayVisible=e},close:t.handleClosePayDialog}},[a("hr"),t._v(" "),a("div",{staticClass:"clearfix"},[a("div",{staticStyle:{float:"left"}},[a("el-form",{model:{value:t.checkInfo,callback:function(e){t.checkInfo=e},expression:"checkInfo"}},[a("el-form-item",{attrs:{label:"支付方式","label-width":"100px"}},[a("el-radio",{attrs:{label:"1"},model:{value:t.payType,callback:function(e){t.payType=e},expression:"payType"}},[t._v("微信支付")]),t._v(" "),a("el-radio",{attrs:{label:"4"},model:{value:t.payType,callback:function(e){t.payType=e},expression:"payType"}},[t._v("余额支付")])],1),t._v(" "),a("el-form-item",{attrs:{label:"活动名称","label-width":"100px"}},[a("span",[t._v(t._s(t.checkInfo.name))])]),t._v(" "),a("el-form-item",{attrs:{label:"活动类型","label-width":"100px"}},[a("span",[t._v(t._s(t._f("activityFilter")(t.checkInfo.type)))])]),t._v(" "),a("el-form-item",{attrs:{label:"活动金额","label-width":"100px"}},[a("span",{staticStyle:{color:"red"}},[t._v(t._s(t.payMoney)+"元")])])],1),t._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"primary"},on:{click:t.handleGetPayEr}},[t._v("确定")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleGobackActivityList}},[t._v("支付完成返回列表")])],1)],1),t._v(" "),a("div",{staticStyle:{float:"right",width:"50%"}},[a("div",{staticClass:"er",staticStyle:{height:"180px",width:"180px",margin:"0 auto","margin-top":"40px"}},[a("img",{attrs:{src:t.pay_er_img,alt:""}})])])])]),t._v(" "),a("el-dialog",{staticClass:"taskListDialog",attrs:{"close-on-click-modal":!1,visible:t.dialogTaskList,title:"题库导入"},on:{"update:visible":function(e){t.dialogTaskList=e},close:t.handleCloseTaskList}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tasklistData,border:"",fit:"","highlight-current-row":""},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"序号",width:"70",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.$index+1)+"\n        ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"题目标题","min-width":"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.name))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"答案",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.answer))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"题目类型",width:"110",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("typeFilter")(e.row.type)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"分值",width:"95",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.score))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"答题类型",align:"center",width:"95"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("answerTypeFilter")(e.row.answer_type)))])]}}])})],1),t._v(" "),a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{"current-page":t.taskListQuery.page_no,"page-size":t.taskListQuery.page_size,total:t.taskTotal,background:""},on:{"current-change":t.handleaTaskCurrentChange}})],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.handleCloseTaskList}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmitLibTask}},[t._v("确 定")])],1)],1),t._v(" "),a("el-dialog",{staticClass:"activityDialog",attrs:{"close-on-click-modal":!1,visible:t.dialogMap,title:"选择定位"},on:{"update:visible":function(e){t.dialogMap=e}}},[a("div",{staticClass:"search-area"},[a("el-input",{staticStyle:{width:"400px","margin-bottom":"10px"},attrs:{placeholder:"请输入地址（如需搜索城市请加上城市所在上级地址）"},model:{value:t.searchLocation,callback:function(e){t.searchLocation=e},expression:"searchLocation"}}),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleSearchLocation}},[t._v("搜索")])],1),t._v(" "),a("div",{staticStyle:{width:"100%",height:"500px"},attrs:{id:"map-container"}}),t._v(" "),a("div",{staticStyle:{"text-align":"center","margin-top":"20px"}},[a("el-button",{attrs:{type:"primary"},on:{click:t.handleSaveLocation}},[t._v("保存定位")])],1)]),t._v(" "),t.is_progress?a("div",{staticClass:"progress_wrap",attrs:{id:"progress"}},[a("div",{staticClass:"progress_wraps"},[a("div",{staticClass:"progress_bg"}),t._v(" "),a("div",{staticClass:"progress_content"},[a("el-progress",{attrs:{percentage:t.jindu,type:"circle"}})],1)])]):t._e()],1)},[],!1,null,null,null);L.options.__file="activityManage.vue";e.default=L.exports},"8SHQ":function(t,e,a){"use strict";a.d(e,"a",function(){return i});var i="http://cdnimg.bxunion.com"},NhRW:function(t,e,a){},ZySA:function(t,e,a){"use strict";var i=a("P2sY"),n=a.n(i),s=(a("jUE0"),{bind:function(t,e){t.addEventListener("click",function(a){var i=n()({},e.value),s=n()({ele:t,type:"hit",color:"rgba(0, 0, 0, 0.15)"},i),o=s.ele;if(o){o.style.position="relative",o.style.overflow="hidden";var l=o.getBoundingClientRect(),r=o.querySelector(".waves-ripple");switch(r?r.className="waves-ripple":((r=document.createElement("span")).className="waves-ripple",r.style.height=r.style.width=Math.max(l.width,l.height)+"px",o.appendChild(r)),s.type){case"center":r.style.top=l.height/2-r.offsetHeight/2+"px",r.style.left=l.width/2-r.offsetWidth/2+"px";break;default:r.style.top=(a.pageY-l.top-r.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",r.style.left=(a.pageX-l.left-r.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return r.style.backgroundColor=s.color,r.className="waves-ripple z-active",!1}},!1)}}),o=function(t){t.directive("waves",s)};window.Vue&&(window.waves=s,Vue.use(o)),s.install=o;e.a=s},"gDS+":function(t,e,a){t.exports={default:a("oh+g"),__esModule:!0}},hoD4:function(t,e,a){"use strict";var i=a("NhRW");a.n(i).a},jUE0:function(t,e,a){},"oh+g":function(t,e,a){var i=a("WEpk"),n=i.JSON||(i.JSON={stringify:JSON.stringify});t.exports=function(t){return n.stringify.apply(n,arguments)}},zK94:function(t,e,a){"use strict";a.d(e,"a",function(){return n}),a.d(e,"r",function(){return s}),a.d(e,"s",function(){return o}),a.d(e,"o",function(){return l}),a.d(e,"v",function(){return r}),a.d(e,"d",function(){return c}),a.d(e,"q",function(){return u}),a.d(e,"f",function(){return d}),a.d(e,"j",function(){return p}),a.d(e,"A",function(){return f}),a.d(e,"H",function(){return m}),a.d(e,"m",function(){return h}),a.d(e,"p",function(){return v}),a.d(e,"t",function(){return y}),a.d(e,"x",function(){return g}),a.d(e,"u",function(){return _}),a.d(e,"n",function(){return b}),a.d(e,"e",function(){return k}),a.d(e,"J",function(){return w}),a.d(e,"i",function(){return I}),a.d(e,"D",function(){return x}),a.d(e,"b",function(){return T}),a.d(e,"k",function(){return C}),a.d(e,"I",function(){return L}),a.d(e,"E",function(){return S}),a.d(e,"g",function(){return A}),a.d(e,"F",function(){return j}),a.d(e,"z",function(){return $}),a.d(e,"y",function(){return O}),a.d(e,"B",function(){return q}),a.d(e,"C",function(){return D}),a.d(e,"c",function(){return F}),a.d(e,"h",function(){return U}),a.d(e,"G",function(){return V}),a.d(e,"w",function(){return N}),a.d(e,"l",function(){return Q});var i=a("t3Un");function n(t){return Object(i.a)({url:"/i/topteam/admin/addactivity",method:"post",data:t})}function s(t){return Object(i.a)({url:"/i/topteam/admin/GetActivityList",method:"post",data:t})}function o(){return Object(i.a)({url:"/i/topteam/admin/getcoachlist",method:"get"})}function l(t){return Object(i.a)({url:"/i/topteam/admin/delactivity?act_id="+t,method:"get"})}function r(t){return Object(i.a)({url:"/i/topteam/admin/GetTaskList",method:"post",data:t})}function c(t){return Object(i.a)({url:"i/topteam/admin/addTask",method:"post",data:t})}function u(t){return Object(i.a)({url:"/i/topteam/admin/getactivityinfo",method:"post",data:t})}function d(t){return Object(i.a)({url:"/i/topteam/admin/auditact",method:"post",data:t})}function p(t){return Object(i.a)({url:"/i/topteam/api/createorder",method:"post",data:t})}function f(t){return Object(i.a)({url:"/i/topteam/api/getpayinfo",method:"post",data:t})}function m(t){return Object(i.a)({url:"/i/topteam/admin/updateactivity",method:"post",data:t})}function h(t){return Object(i.a)({url:"/i/topteam/admin/delTask?id="+t,method:"get"})}function v(t){return Object(i.a)({url:"/i/topteam/admin/ModifyTask",method:"post",data:t})}function y(t){return Object(i.a)({url:"/i/topteam/admin/GetActivityList",method:"post",data:t})}function g(t){return Object(i.a)({url:"/i/topteam/admin/getactteamloginfo?act_id="+t,method:"get"})}function _(t){return Object(i.a)({url:"/i/topteam/admin/getTaskLibList",method:"post",data:t})}function b(t){return Object(i.a)({url:"/i/topteam/admin/delTaskLib?id="+t,method:"get"})}function k(t){return Object(i.a)({url:"/i/topteam/admin/addTaskLib",method:"post",data:t})}function w(t){return Object(i.a)({url:"/i/topteam/admin/ModifyTaskLib",method:"post",data:t})}function I(t){return Object(i.a)({url:"/i/topteam/admin/ChooseTasklib",method:"post",data:t})}function x(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{page_no:1,page_size:1e3};return Object(i.a)({url:"/i/topteam/admin/getclassifylist",method:"get",data:t})}function T(t){return Object(i.a)({url:"/i/topteam/admin/addclassify",method:"post",data:t})}function C(t){return Object(i.a)({url:"/i/topteam/admin/delclassify",method:"post",data:t})}function L(t){return Object(i.a)({url:"/i/topteam/admin/Modifyclassify",method:"post",data:t})}function S(t){return Object(i.a)({url:"/i/topteam/admin/getactploginfo",method:"post",data:t})}function A(t){return Object(i.a)({url:"/i/topteam/admin/cancelact?act_id="+t,method:"get"})}function j(t,e){return Object(i.a)({url:"/i/topteam/admin/MoveTask?id="+t+"&move_type="+e})}function $(t){return Object(i.a)({url:"/i/topteam/admin/getactptloginfo",method:"post",data:t})}function O(t){return Object(i.a)({url:"/i/topteam/admin/getfenxipact",method:"post",data:t})}function q(t){return Object(i.a)({url:"/i/topteam/admin/getanswerrecord",method:"post",data:t})}function D(t){return Object(i.a)({url:"/i/topteam/admin/getanswerstatistics",method:"post",data:t})}function F(t){return Object(i.a)({url:"/i/topteam/admin/addgame",method:"post",data:t})}function U(t){return Object(i.a)({url:"/i/topteam/admin/updategame",method:"post",data:t})}function V(t){return Object(i.a)({url:"/i/topteam/admin/onsale",method:"post",data:t})}function N(t){return Object(i.a)({url:"/i/topteam/admin/getgamelist",method:"post",data:t})}function Q(t){return Object(i.a)({url:"/i/topteam/admin/delgame",method:"post",data:t})}}}]);