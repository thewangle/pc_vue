(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-dd64"],{"+UXW":function(t,e,a){"use strict";a.r(e);var i=a("14Xm"),n=a.n(i),l=a("D3Ub"),o=a.n(l),s=a("t3Un");function r(t){return Object(s.a)({url:"/i/topteam/admin/addactivity",method:"post",data:t})}function c(t){return Object(s.a)({url:"/i/topteam/admin/GetActivityList",method:"post",data:t})}var u=a("+vOl"),d=a("X4fA"),p=a("vDqi"),v=a.n(p),f={name:"ActivityManage",directives:{waves:a("ZySA").a},filters:{statusFilter:function(t){return{1:"待审核",2:"准备中审核通过",3:"已开始进行中",4:"暂停",5:"结束已完成 ",6:"审核未通过",7:"删除"}[t]},activityFilter:function(t){return{1:"团队-基础版",2:"团队-精英版",3:"个人-基础版",4:"个人-精英版"}[t]}},data:function(){return{list:null,listLoading:!1,listQuery:{type:null,agent_name:null,name:null,status:null},activities:[{label:"团队-基础版",key:1},{label:"团队-精英版",key:2},{label:"个人-基础版",key:3},{label:"个人-基础版",key:4}],status:[{label:"待审批",key:"1"},{label:"准备中",key:"2"},{label:"进行中",key:"3"},{label:"暂停中",key:"4"},{label:"已完成",key:"5"},{label:"未通过",key:"6"}],dialogFormVisible:!1,activityInfo:{agentName:Object(d.b)(),type:"",coachId:"",name:"",keepTime:"",score:"",scoreType:"",scoreShowType:"",time:"",actDesc:"",bgImgUrl:"",iconUrl:""},dialogImageUrl:"",dialogVisible:!1,coachList:[],domain:"http://upload.qiniup.com/",qiniuAddress:"http://cdnimg.bxunion.com"}},created:function(){this.init()},methods:{handleFilter:function(){this._fetchActivityList()},handleCreateActivity:function(){this.dialogFormVisible=!0},handleBgCardPreview:function(){this.dialogImageUrl=this.activityInfo.bgImgUrl,this.dialogVisible=!0},handleIconCardPreview:function(){this.dialogImageUrl=this.activityInfo.iconUrl,this.dialogVisible=!0},handleUpLoadBgImg:function(t){this._uploadQiNiu(t,"bgImg")},handleUpLoadIconImg:function(t){this._uploadQiNiu(t,"icon")},handleCreateActivitySubmit:function(){console.log(this.activityInfo),this._addActivity()},_uploadQiNiu:function(t,e){var a=this;return o()(n.a.mark(function i(){var l,o,s,r,c;return n.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return l={headers:{"Content-Type":"multipart/form-data"}},o="",o="image/png"===t.file.type?"png":"jpg",s="top-team"+Date.now()+Math.floor(100*Math.random())+"."+o,i.next=6,a._fetchQiNiuToken();case 6:r=i.sent,(c=new FormData).append("file",t.file),c.append("token",r),c.append("key",s),v.a.post(a.domain,c,l).then(function(t){var i=a.qiniuAddress+"/"+t.data.key;"bgImg"===e&&(a.activityInfo.bgImgUrl=i),"icon"===e&&(a.activityInfo.iconUrl=i)});case 12:case"end":return i.stop()}},i,a)}))()},_fetchCoachList:function(){var t=this;return o()(n.a.mark(function e(){var a,i;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(s.a)({url:"/i/topteam/admin/getcoachlist",method:"get"});case 2:a=e.sent,i=a.data,t.coachList=i;case 5:case"end":return e.stop()}},e,t)}))()},_fetchQiNiuToken:function(){var t=this;return o()(n.a.mark(function e(){var a,i;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(u.c)();case 2:return a=t.sent,i=a.data,t.abrupt("return",i);case 5:case"end":return t.stop()}},e,t)}))()},_addActivity:function(){var t=this;return o()(n.a.mark(function e(){var a,i,l,o,s,c,u,p,v,f,m,y,h,b;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a={},i=t.activityInfo,l=i.time,o=i.name,s=i.keepTime,c=i.score,u=i.coachId,p=i.actDesc,v=i.scoreType,f=i.scoreShowType,m=i.type,y=i.bgImgUrl,h=i.iconUrl,l.length&&o&&s&&c&&u&&m){e.next=5;break}return t.$message({message:"必填项不能为空",type:"error"}),e.abrupt("return");case 5:return a.set_start_time=l[0]/1e3,a.set_stop_time=l[1]/1e3,a.agent_id=Object(d.a)(),a.name=o,a.keep_time=s,a.score=c,a.coach_id=u,a.act_desc=p,a.score_type=v,a.score_show_type=f,a.type=m,a.bg_img=y,a.icon=h,a.money=400,e.next=21,r(a);case 21:b=e.sent,console.log(b);case 23:case"end":return e.stop()}},e,t)}))()},_fetchActivityList:function(){var t=this;return o()(n.a.mark(function e(){var a,i;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.listLoading=!0,e.prev=1,e.next=4,c(t.listQuery);case 4:a=e.sent,i=a.data,t.listLoading=!1,console.log(i),t.list=i,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.listLoading=!1;case 14:case"end":return e.stop()}},e,t,[[1,11]])}))()},init:function(){this._fetchCoachList(),this._fetchActivityList()}}},m=(a("hoD4"),a("KHd+")),y=Object(m.a)(f,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"请输入运营商名称"},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.handleFilter(e):null}},model:{value:t.listQuery.agent_name,callback:function(e){t.$set(t.listQuery,"agent_name",e)},expression:"listQuery.agent_name"}}),t._v(" "),a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"请输入活动名称"},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.handleFilter(e):null}},model:{value:t.listQuery.name,callback:function(e){t.$set(t.listQuery,"name",e)},expression:"listQuery.name"}}),t._v(" "),a("el-select",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"请选择活动类型",clearable:""},on:{change:t.handleFilter},model:{value:t.listQuery.type,callback:function(e){t.$set(t.listQuery,"type",e)},expression:"listQuery.type"}},t._l(t.activities,function(t){return a("el-option",{key:t.key,attrs:{label:t.label,value:t.key}})})),t._v(" "),a("el-select",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"请选择活动状态",clearable:""},on:{change:t.handleFilter},model:{value:t.listQuery.status,callback:function(e){t.$set(t.listQuery,"status",e)},expression:"listQuery.status"}},t._l(t.status,function(t){return a("el-option",{key:t.key,attrs:{label:t.label,value:t.key}})})),t._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.handleFilter}},[t._v("查询")]),t._v(" "),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:t.handleCreateActivity}},[t._v("新增活动")])],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:t.list,border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{label:"序号",align:"center",width:"65"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.$index+1))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"运营商",width:"150px",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.agent_name))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"活动名称","min-width":"130px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.name))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"游戏类型",width:"110px",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("activityFilter")(e.row.status)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"活动封面",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.icon))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"活动时间",align:"center",width:"95"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.keep_time)+"分钟")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"初始分值",align:"center",width:"95"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.score))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"活动状态","class-name":"status-col",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("statusFilter")(e.row.activity_status)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center","min-width":"230","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",size:"mini"}},[t._v("修改")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"success"}},[t._v("查看\n        ")]),t._v(" "),a("el-button",{attrs:{size:"mini"}},[t._v("去审批\n        ")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"}},[t._v("删除\n        ")])]}}])})],1),t._v(" "),a("el-dialog",{staticClass:"activityDialog",attrs:{visible:t.dialogFormVisible,title:"新增活动",fullscreen:""},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("hr"),t._v(" "),a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.activityInfo}},[a("el-form-item",{attrs:{label:"运营商名"}},[a("el-input",{attrs:{disabled:""},model:{value:t.activityInfo.agentName,callback:function(e){t.$set(t.activityInfo,"agentName",e)},expression:"activityInfo.agentName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"活动类型"}},[a("el-select",{model:{value:t.activityInfo.type,callback:function(e){t.$set(t.activityInfo,"type",e)},expression:"activityInfo.type"}},[a("el-option",{attrs:{label:"团队-基础版",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"团队-精英版",value:"2"}}),t._v(" "),a("el-option",{attrs:{label:"个人-基础版",value:"3"}}),t._v(" "),a("el-option",{attrs:{label:"个人-精英版",value:"4"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"选择教练"}},[a("el-select",{model:{value:t.activityInfo.coachId,callback:function(e){t.$set(t.activityInfo,"coachId",e)},expression:"activityInfo.coachId"}},t._l(t.coachList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"活动名称"}},[a("el-input",{model:{value:t.activityInfo.name,callback:function(e){t.$set(t.activityInfo,"name",e)},expression:"activityInfo.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"活动时长（分钟）"}},[a("el-input",{attrs:{type:"number",min:"0"},model:{value:t.activityInfo.keepTime,callback:function(e){t.$set(t.activityInfo,"keepTime",e)},expression:"activityInfo.keepTime"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"起始分值"}},[a("el-input",{attrs:{type:"number",min:"0"},model:{value:t.activityInfo.score,callback:function(e){t.$set(t.activityInfo,"score",e)},expression:"activityInfo.score"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"分值形式"}},[a("el-select",{model:{value:t.activityInfo.scoreType,callback:function(e){t.$set(t.activityInfo,"scoreType",e)},expression:"activityInfo.scoreType"}},[a("el-option",{attrs:{label:"积分",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"砖石",value:"2"}}),t._v(" "),a("el-option",{attrs:{label:"游戏币",value:"3"}}),t._v(" "),a("el-option",{attrs:{label:"花瓣",value:"4"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"可见分数"}},[a("el-select",{model:{value:t.activityInfo.scoreShowType,callback:function(e){t.$set(t.activityInfo,"scoreShowType",e)},expression:"activityInfo.scoreShowType"}},[a("el-option",{attrs:{label:"是",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"否",value:"2"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"起止时间"}},[a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"timestamp"},model:{value:t.activityInfo.time,callback:function(e){t.$set(t.activityInfo,"time",e)},expression:"activityInfo.time"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"活动描述"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.activityInfo.actDesc,callback:function(e){t.$set(t.activityInfo,"actDesc",e)},expression:"activityInfo.actDesc"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"活动封面"}},[a("el-upload",{attrs:{"http-request":t.handleUpLoadIconImg,"on-preview":t.handleIconCardPreview,limit:1,action:t.domain,"list-type":"picture-card"}},[a("el-button",[t._v("上传图片")])],1),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("img",{attrs:{src:t.dialogImageUrl,width:"100%",alt:""}})])],1),t._v(" "),a("el-form-item",{attrs:{label:"活动背景"}},[a("el-upload",{attrs:{"http-request":t.handleUpLoadBgImg,"on-preview":t.handleBgCardPreview,limit:1,action:t.domain,"list-type":"picture-card"}},[a("el-button",[t._v("上传图片")])],1)],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.handleCreateActivitySubmit}},[t._v("创建活动")])],1)],1),t._v(" "),a("hr")],1)],1)},[],!1,null,null,null);y.options.__file="activityManage.vue";e.default=y.exports},NhRW:function(t,e,a){},ZySA:function(t,e,a){"use strict";var i=a("P2sY"),n=a.n(i),l=(a("jUE0"),{bind:function(t,e){t.addEventListener("click",function(a){var i=n()({},e.value),l=n()({ele:t,type:"hit",color:"rgba(0, 0, 0, 0.15)"},i),o=l.ele;if(o){o.style.position="relative",o.style.overflow="hidden";var s=o.getBoundingClientRect(),r=o.querySelector(".waves-ripple");switch(r?r.className="waves-ripple":((r=document.createElement("span")).className="waves-ripple",r.style.height=r.style.width=Math.max(s.width,s.height)+"px",o.appendChild(r)),l.type){case"center":r.style.top=s.height/2-r.offsetHeight/2+"px",r.style.left=s.width/2-r.offsetWidth/2+"px";break;default:r.style.top=(a.pageY-s.top-r.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",r.style.left=(a.pageX-s.left-r.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return r.style.backgroundColor=l.color,r.className="waves-ripple z-active",!1}},!1)}}),o=function(t){t.directive("waves",l)};window.Vue&&(window.waves=l,Vue.use(o)),l.install=o;e.a=l},hoD4:function(t,e,a){"use strict";var i=a("NhRW");a.n(i).a},jUE0:function(t,e,a){}}]);